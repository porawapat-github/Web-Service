{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\naxios.defaults.withCredentials = true;\nexport default {\n  name: \"EditRoom\",\n  data() {\n    return {\n      roomId: null,\n      roomName: null,\n      roomSize: null,\n      roomDetail: null,\n      roomPrice: null,\n      roomStatus: null,\n      roomData: [],\n      dataId: null,\n      backendMessage: null,\n      imageExists: false,\n      fileMessage: null,\n      file: null,\n      imageTimestamp: Date.now() // ใช้เป็น query parameter ในการโหลดรูปภาพ\n    };\n  },\n  async mounted() {\n    this.dataId = this.$route.params.dataTest;\n    axios.get(`http://localhost:3000/admin/room/${this.dataId}`).then(res => {\n      // console.log(res.data[0]);\n      this.roomData = res.data;\n      this.roomId = this.roomData[0].roomId;\n      this.roomName = this.roomData[0].roomName;\n      this.roomSize = this.roomData[0].roomSize;\n      this.roomDetail = this.roomData[0].roomDetail;\n      this.roomPrice = this.roomData[0].roomPrice;\n      this.roomStatus = this.roomData[0].roomStatus;\n      this.checkImage();\n    }).catch(err => {\n      console.error(err);\n    });\n  },\n  methods: {\n    onFileChange(e) {\n      this.file = e.target.files[0];\n    },\n    // ทำการ Uploadfile เมื่อถูกSubmit\n    async uploadFile() {\n      if (!this.file) {\n        this.fileMessage = \"เลือก File ก่อน\";\n        return;\n      }\n      // อ่านค่าจาก Form เพื่อ POST\n      const formData = new FormData();\n      formData.append(\"file\", this.file);\n      // กำหนด endpoint และกำหนด Header ว่าเป็นการส่ง file\n      try {\n        const response = await axios.post(`http://localhost:3000/admin/uploadRoomImage/${this.roomId}/${this.roomName}`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\"\n          }\n        });\n        this.fileMessage = response.data.message;\n        // ให้ทำการตรวจสอบ image อีกครั้ง\n        this.checkImage();\n        this.imageTimestamp = Date.now();\n      } catch (err) {\n        this.fileMessage = \"fail\";\n      }\n    },\n    checkImage() {\n      console.log(\"Is Success \" + this.imageExists);\n      console.log(this.roomName);\n      const image = new Image();\n      image.src = `http://localhost:3000/img_room/${this.roomId}_${this.roomName}.jpg`;\n      image.onload = () => {\n        console.log(\"Is Success \" + this.imageExists);\n        // รูปภาพโหลดสำเร็จ\n        this.imageExists = true;\n      };\n      console.log(\"Is Success \" + this.imageExists);\n      image.onerror = () => {\n        // รูปภาพไม่สามารถโหลดได้\n\n        this.imageExists = false;\n      };\n    },\n    async updateRoom() {\n      let room = {\n        roomName: this.roomName,\n        roomSize: this.roomSize,\n        roomDetail: this.roomDetail,\n        roomPrice: this.roomPrice,\n        roomStatus: this.roomStatus\n      };\n      try {\n        const res = await axios.put(`http://localhost:3000/admin/putRoom/${this.dataId}`, room);\n        this.backendMessage = res.data.messagePutRoom;\n        if (this.backendMessage == \"success\") {\n          this.$router.push(\"/ManageRoom\");\n        }\n      } catch (err) {\n        console.log(err);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","defaults","withCredentials","name","data","roomId","roomName","roomSize","roomDetail","roomPrice","roomStatus","roomData","dataId","backendMessage","imageExists","fileMessage","file","imageTimestamp","Date","now","mounted","$route","params","dataTest","get","then","res","checkImage","catch","err","console","error","methods","onFileChange","e","target","files","uploadFile","formData","FormData","append","response","post","headers","message","log","image","Image","src","onload","onerror","updateRoom","room","put","messagePutRoom","$router","push"],"sources":["D:\\Room-Reservation\\Web-Service\\frontend\\src\\components\\EditRoom.vue"],"sourcesContent":["<template>\r\n  <div class=\"edit-room-page\">\r\n    <form @submit.prevent=\"updateRoom\" class=\"edit-room-form\">\r\n      <div class=\"add-room-form\">\r\n        <div class=\"card-body\">\r\n          <h1 class=\"card-title text-secondary text-center\">เเก้ไขห้อง</h1>\r\n\r\n          <!-- ชื่อห้อง -->\r\n          <div class=\"form-group\">\r\n            <label for=\"roomName\" class=\"form-label\">ชื่อห้อง</label>\r\n            <select\r\n              class=\"form-control\"\r\n              id=\"roomName\"\r\n              required\r\n              v-model.trim=\"roomName\"\r\n            >\r\n              <option disabled value=\"\">เลือกชื่อห้อง</option>\r\n              <option value=\"Standard Room\">Standard Room</option>\r\n              <option value=\"Luxury Room\">Luxury Room</option>\r\n              <option value=\"Suite Room\">Suite Room</option>\r\n            </select>\r\n          </div>\r\n\r\n          <!-- สถานะห้อง -->\r\n          <div class=\"form-group\">\r\n            <label for=\"roomStatus\" class=\"form-label\">สถานะห้อง</label>\r\n            <select\r\n              class=\"form-control\"\r\n              id=\"roomStatus\"\r\n              required\r\n              v-model.trim=\"roomStatus\"\r\n            >\r\n              <option value=\"Free\">Free</option>\r\n              <option value=\"Full\">Full</option>\r\n            </select>\r\n          </div>\r\n\r\n          <!-- ขนาดห้อง -->\r\n          <div class=\"form-group\">\r\n            <label for=\"roomSize\" class=\"form-label\">ขนาดห้อง / คน</label>\r\n            <select\r\n              class=\"form-control\"\r\n              id=\"roomSize\"\r\n              required\r\n              v-model.trim=\"roomSize\"\r\n            >\r\n              <option disabled value=\"\">(จำนวนคน)</option>\r\n              <option value=\"1\">1 คน</option>\r\n              <option value=\"2\">2 คน</option>\r\n              <option value=\"3\">3 คน</option>\r\n              <option value=\"4\">4 คน</option>\r\n            </select>\r\n          </div>\r\n\r\n          <!-- รายละเอียดห้อง -->\r\n          <div class=\"form-group\">\r\n            <label for=\"roomDetail\" class=\"form-label\">รายละเอียดห้อง</label>\r\n            <input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              id=\"roomDetail\"\r\n              required\r\n              v-model.trim=\"roomDetail\"\r\n            />\r\n          </div>\r\n\r\n          <!-- ราคาห้อง -->\r\n          <div class=\"form-group\">\r\n            <label for=\"roomPrice\" class=\"form-label\">ราคาห้อง</label>\r\n            <input\r\n              type=\"text\"\r\n              class=\"form-control\"\r\n              id=\"roomPrice\"\r\n              required\r\n              v-model.trim=\"roomPrice\"\r\n            />\r\n          </div>\r\n\r\n          <!-- อัพโหลดรูปภาพ -->\r\n          <div class=\"upload-section\">\r\n            <div v-if=\"imageExists\" class=\"image-preview\">\r\n              <img\r\n                :src=\"`http://localhost:3000/img_room/${roomId}_${roomName}.jpg?timestamp=${imageTimestamp}`\"\r\n                :alt=\"roomName\"\r\n                class=\"room-image\"\r\n              />\r\n            </div>\r\n            <div v-else class=\"image-preview\">\r\n              <img\r\n                :src=\"`http://localhost:3000/img_room/default.jpg`\"\r\n                :alt=\"roomName\"\r\n                class=\"room-image\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <form @submit.prevent=\"uploadFile\">\r\n                <input\r\n                  class=\"form-control mb-3\"\r\n                  type=\"file\"\r\n                  @change=\"onFileChange\"\r\n                />\r\n              </form>\r\n              <button class=\"btn upload\" type=\"submit\">Upload</button>\r\n              <button class=\"btn submit\" type=\"submit\">\r\n                <i class=\"bi bi-check-lg\"></i>&nbsp;Submit\r\n              </button>\r\n            </div>\r\n            <div v-if=\"fileMessage\" class=\"alert alert-success mt-3\">\r\n              {{ fileMessage }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\naxios.defaults.withCredentials = true;\r\nexport default {\r\n  name: \"EditRoom\",\r\n  data() {\r\n    return {\r\n      roomId: null,\r\n      roomName: null,\r\n      roomSize: null,\r\n      roomDetail: null,\r\n      roomPrice: null,\r\n      roomStatus: null,\r\n      roomData: [],\r\n      dataId: null,\r\n      backendMessage: null,\r\n      imageExists: false,\r\n      fileMessage: null,\r\n      file: null,\r\n      imageTimestamp: Date.now(), // ใช้เป็น query parameter ในการโหลดรูปภาพ\r\n    };\r\n  },\r\n  async mounted() {\r\n    this.dataId = this.$route.params.dataTest;\r\n    axios\r\n      .get(`http://localhost:3000/admin/room/${this.dataId}`)\r\n      .then((res) => {\r\n        // console.log(res.data[0]);\r\n        this.roomData = res.data;\r\n        this.roomId = this.roomData[0].roomId;\r\n        this.roomName = this.roomData[0].roomName;\r\n        this.roomSize = this.roomData[0].roomSize;\r\n        this.roomDetail = this.roomData[0].roomDetail;\r\n        this.roomPrice = this.roomData[0].roomPrice;\r\n        this.roomStatus = this.roomData[0].roomStatus;\r\n        this.checkImage();\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n  },\r\n  methods: {\r\n    onFileChange(e) {\r\n      this.file = e.target.files[0];\r\n    },\r\n    // ทำการ Uploadfile เมื่อถูกSubmit\r\n    async uploadFile() {\r\n      if (!this.file) {\r\n        this.fileMessage = \"เลือก File ก่อน\";\r\n        return;\r\n      }\r\n      // อ่านค่าจาก Form เพื่อ POST\r\n      const formData = new FormData();\r\n      formData.append(\"file\", this.file);\r\n      // กำหนด endpoint และกำหนด Header ว่าเป็นการส่ง file\r\n      try {\r\n        const response = await axios.post(\r\n          `http://localhost:3000/admin/uploadRoomImage/${this.roomId}/${this.roomName}`,\r\n          formData,\r\n          {\r\n            headers: {\r\n              \"Content-Type\": \"multipart/form-data\",\r\n            },\r\n          }\r\n        );\r\n        this.fileMessage = response.data.message;\r\n        // ให้ทำการตรวจสอบ image อีกครั้ง\r\n        this.checkImage();\r\n        this.imageTimestamp = Date.now();\r\n      } catch (err) {\r\n        this.fileMessage = \"fail\";\r\n      }\r\n    },\r\n\r\n    checkImage() {\r\n      console.log(\"Is Success \" + this.imageExists);\r\n      console.log(this.roomName);\r\n      const image = new Image();\r\n      image.src = `http://localhost:3000/img_room/${this.roomId}_${this.roomName}.jpg`;\r\n      image.onload = () => {\r\n        console.log(\"Is Success \" + this.imageExists);\r\n        // รูปภาพโหลดสำเร็จ\r\n        this.imageExists = true;\r\n      };\r\n      console.log(\"Is Success \" + this.imageExists);\r\n      image.onerror = () => {\r\n        // รูปภาพไม่สามารถโหลดได้\r\n\r\n        this.imageExists = false;\r\n      };\r\n    },\r\n\r\n    async updateRoom() {\r\n      let room = {\r\n        roomName: this.roomName,\r\n        roomSize: this.roomSize,\r\n        roomDetail: this.roomDetail,\r\n        roomPrice: this.roomPrice,\r\n        roomStatus: this.roomStatus,\r\n      };\r\n\r\n      try {\r\n        const res = await axios.put(\r\n          `http://localhost:3000/admin/putRoom/${this.dataId}`,\r\n          room\r\n        );\r\n        this.backendMessage = res.data.messagePutRoom;\r\n        if (this.backendMessage == \"success\") {\r\n          this.$router.push(\"/ManageRoom\");\r\n        }\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.edit-room-page {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  min-height: 120vh;\r\n  border-radius: 100px;\r\n  background: linear-gradient(135deg, #d3cce3, #e9e4f0);\r\n  padding: 40px;\r\n}\r\n\r\n.edit-room-form {\r\n  background-color: #ffffff;\r\n  border-radius: 100px;\r\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\r\n  max-width: 1000px;\r\n  padding: 150px 50px;\r\n  width: 100vh;\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.edit-room-form:hover {\r\n  transform: scale(1.02);\r\n}\r\n\r\n.form-group {\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.upload-section {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n\r\n.image-preview {\r\n  width: 300px;\r\n  height: 200px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.room-image {\r\n  width: 100%;\r\n  height: auto;\r\n  border-radius: 8px;\r\n  box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);\r\n}\r\n\r\n.form-control {\r\n  flex: 1; /* ทำให้ input ขยายเต็มพื้นที่ */\r\n}\r\n\r\n.btn {\r\n  margin-left: 10px; /* เพิ่มระยะห่างระหว่างปุ่ม */\r\n}\r\n\r\n.upload {\r\n  background: linear-gradient(45deg, #f19b55, #ec4b1a, #ee2424);\r\n}\r\n\r\n.submit {\r\n  background: linear-gradient(45deg, #bdff80, #7fff4c, #0edb7c);\r\n}\r\n\r\n.justify-content-center {\r\n  justify-content: center;\r\n}\r\n\r\n.upload,\r\n.submit {\r\n  width: 150px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}